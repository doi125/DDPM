以下のサイトを元に実装しました。
The Annotated Diffusion Model
https://huggingface.co/blog/annotated-diffusion
